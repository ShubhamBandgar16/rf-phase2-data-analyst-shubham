import pandas as pd

# Load CSV with correct encoding
df = pd.read_csv("sales_data_sample.csv", encoding='ISO-8859-1')

# Remove leading/trailing spaces from column names
df.columns = df.columns.str.strip()

# 1️) Check for missing values
print("Missing values per column:")
print(df.isnull().sum())

# 2️) Drop duplicates
print("\nNumber of duplicate rows:", df.duplicated().sum())
df = df.drop_duplicates()

# 3️) Convert date column
df['ORDERDATE'] = pd.to_datetime(df['ORDERDATE'], errors='coerce')

# 4️) Optional: Standardize text columns (example: PRODUCTLINE)
df['PRODUCTLINE'] = df['PRODUCTLINE'].str.lower()

# 5️)  Save cleaned CSV
df.to_csv("sales_data_cleaned.csv", index=False)
print("\n✅ Cleaned CSV saved as 'sales_data_cleaned.csv'")

